<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UltraLink - Iniciar Sesión</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ... (Estilos CSS sin cambios) ... */
    </style>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
</head>
<body class="flex flex-col items-center justify-center text-white p-4">

    <div id="authCard" class="w-full max-w-sm mx-auto my-auto p-8 bg-gray-900 rounded-2xl shadow-2xl border border-gray-800">
        
        <div id="recaptcha-container" class="mt-5 flex justify-center"></div> 
        
    </div> 
    
    <script>
        // CONFIGURACIÓN DE FIREBASE (sin cambios funcionales)
        const firebaseConfig = {
            apiKey: "AIzaSyBVdwu74rhD6753ChjVC1PcIAbpQ8th9Rk",
            authDomain: "ultralinkargentina-97c4d.firebaseapp.com",
            projectId: "ultralinkargentina-97c4d",
            storageBucket: "ultralinkargentina-97c4d.appspot.com",
            messagingSenderId: "352589034055",
            appId: "1:352589034055:web:0680b9da02bf0060717762",
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const googleProvider = new firebase.auth.GoogleAuthProvider();
        let confirmationResult = null;

        // ... (Resto de funciones: auth.onAuthStateChanged, switchTab, showMessage, hideMessage, authForm, etc. sin cambios) ...

        // Lógica de Autenticación por Teléfono (SMS) - Mantiene la modificación para debugging
        async function signInWithPhone() {
            const phoneNumber = document.getElementById('phoneNumber').value;
            
            if (!phoneNumber.startsWith('+') || phoneNumber.length < 10) {
                showMessage('Por favor, ingresa el número de teléfono con el código de país (ej: +54 9...).', 'error');
                return;
            }

            try {
                const recaptcha = window.recaptchaVerifier;
                if (!recaptcha) {
                    showMessage('Error: El verificador reCAPTCHA no está inicializado.', 'error');
                    return;
                }

                document.getElementById('sendSmsButton').classList.add('hidden');
                document.getElementById('verifyCodeContainer').classList.remove('hidden');

                confirmationResult = await auth.signInWithPhoneNumber(phoneNumber, recaptcha);
                showMessage(`Código de verificación enviado a ${phoneNumber}.`, 'success');

            } catch (error) {
                // Muestra el código de error de Firebase si persiste
                let errorMsg = 'Error al enviar el código SMS. Inténtalo de nuevo.';
                
                if (error.code === 'auth/invalid-phone-number') {
                    errorMsg = 'El número de teléfono es inválido o el formato es incorrecto.';
                } else if (error.code === 'auth/quota-exceeded') {
                    errorMsg = 'Se ha excedido la cuota de SMS para este proyecto. Revisa la facturación de Firebase.';
                } else if (error.code) {
                    errorMsg = `FALLO CRÍTICO: ${error.code}.`;
                }
                
                showMessage(errorMsg, 'error');
                
                console.error('Firebase Phone Auth Error:', error.code, error.message);
                
                document.getElementById('sendSmsButton').classList.remove('hidden');
                document.getElementById('verifyCodeContainer').classList.add('hidden');
            }
        }

        async function verifyCode() {
            // ... (Función verifyCode sin cambios) ...
        }

        window.addEventListener('load', () => {
            const recaptchaContainer = document.getElementById('recaptcha-container');
            if (recaptchaContainer) {
                window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
                    'size': 'normal' 
                });
                recaptchaVerifier.render(); 
            }
        });
    </script>
</body>
</html>
